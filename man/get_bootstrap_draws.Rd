% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/draws.R
\name{get_bootstrap_draws}
\alias{get_bootstrap_draws}
\title{Fit the base imputation model on bootstrap samples}
\usage{
get_bootstrap_draws(
  longdata,
  method,
  use_samp_ids = FALSE,
  first_sample_orig = FALSE
)
}
\arguments{
\item{longdata}{R6 \code{longdata} object containing all relevant input data information.}

\item{method}{A \code{method} object as generated by either
\code{\link[=method_approxbayes]{method_approxbayes()}} or \code{\link[=method_condmean]{method_condmean()}} with argument \code{type = "bootstrap"}.}

\item{use_samp_ids}{Logical. If \code{TRUE}, the sampled subject ids are returned. Otherwise
the subject ids from the original dataset are returned.}

\item{first_sample_orig}{Logical. If \code{TRUE} the function returns \code{method$n_samples + 1} samples where
the first sample contains the parameter estimates from the original dataset and \code{method$n_samples}
samples contain the parameter estimates from bootstrap samples.
If \code{FALSE} the function returns \code{method$n_samples} samples containing the parameter estimates from
bootstrap samples.}
}
\value{
A \code{draws} object which is a named list containing the following:
\itemize{
\item \code{data}: R6 \code{longdata} object containing all relevant input data information.
\item \code{method}: A \code{method} object as generated by either \code{\link[=method_bayes]{method_bayes()}},
\code{\link[=method_approxbayes]{method_approxbayes()}} or \code{\link[=method_condmean]{method_condmean()}}.
\item \code{samples}: list containing the estimated parameters of interest.
Each element of \code{samples} is a named list containing the following:
\itemize{
\item \code{ids}: vector of characters containing the ids of the subjects included in the original dataset.
\item \code{beta}: numeric vector of estimated regression coefficients.
\item \code{sigma}: list of estimated covariance matrices (one for each level of \code{vars$group}).
\item \code{theta}: numeric vector of transformed covariances.
\item \code{failed}: Logical. \code{TRUE} if the model fit failed.
\item \code{ids_samp}: vector of characters containing the ids of the subjects included in the given sample.
}
\item \code{fit}: if \code{method_bayes()} is chosen, returns the MCMC Stan fit object. Otherwise \code{NULL}.
\item \code{n_failures}: absolute number of failures of the model fit.
Relevant only for \code{method_condmean(type = "bootstrap")} and \code{method_approxbayes()}.
\item \code{formula}: fixed effects formula object used for the model specification.
}
}
\description{
Fit the base imputation model using a ML/REML approach on a given number of bootstrap samples as
specified by \code{method$n_samples}. Returns the parameter estimates from the model fit.
}
\details{
Bootstrapping refers to resampling of subjects (and their full longitudinal data) from \code{data} with
replacement and and not to resampling of individual rows from \code{data}.
If the model fit fails in the original dataset, an error message is thrown. If
the model fit fails in a bootstrap sample, then that bootstrap sample is not considered
and replaced by another bootstrap sample. \code{method$threshold} defines the
maximum fraction of model fit failures: if the number of failures overcomes
\code{ceiling(method$threshold * method$n_samples)} the process stops and an error message
is displayed.
}
